# Migration `20201122095011-add-work-out-history`

This migration has been generated by 권수현 at 11/22/2020, 6:50:11 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `WorkOutHistory` (
    `workOutDate` DATETIME(3) DEFAULT CURRENT_TIMESTAMP(3),
    `userId` INT NOT NULL,
    `workOutId` INT NOT NULL,

    PRIMARY KEY (`userId`,`workOutId`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `WorkOutHistory` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `WorkOutHistory` ADD FOREIGN KEY (`workOutId`) REFERENCES `WorkOut`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201122083454-re-name-relation-name..20201122095011-add-work-out-history
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 model Profile {
   id                Int                 @default(autoincrement()) @id
@@ -34,8 +34,9 @@
   totalAccTime      TotalAccTime?
   workOuts          WorkOut[]
   goals             Goal[]
+  workOutHistorys   WorkOutHistory[]
 }
 model Mission {
   id                Int                 @default(autoincrement()) @id
@@ -65,10 +66,21 @@
   deletedAt         DateTime?
   userId            Int?                @unique
   user              User?               @relation(fields: [userId], references: [id])
+  workOutHistorys   WorkOutHistory[]
 }
+model WorkOutHistory {
+  workOutDate       DateTime?           @default(now())
+  
+  userId            Int                 
+  user              User                @relation(fields: [userId], references: [id])
+  workOutId         Int                
+  workOut           WorkOut             @relation(fields: [workOutId], references: [id])
+  @@id([userId, workOutId])
+}
+
 model Goal {
   percent           Int?
   createdAt         DateTime?           @default(now())
```


